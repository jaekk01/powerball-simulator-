<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Powerball Simulator</title>
<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
            Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
        background: white;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    #disclaimer {
        background: #eee;
        padding: 15px;
        font-size: 14px;
        border-bottom: 1px solid #ccc;
    }
    /* Black ticker banner */
    #ticker {
        background: #222;
        color: #fff;
        padding: 8px;
        font-size: 14px;
        overflow: hidden;
    }
    button {
        margin: 20px;
        padding: 15px 25px;
        font-size: 18px;
        cursor: pointer;
        border: none;
        border-radius: 8px;
        background: #2b7cff;
        color: white;
        transition: background-color 0.3s ease;
    }
    button:hover {
        background: #1a4fcc;
    }
    #stats {
        margin-top: 20px;
        font-size: 16px;
    }

    /* Left side news */
    .news-panel {
        position: fixed;
        left: 12px;
        bottom: 12px;
        width: 320px;
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        padding: 10px;
        font-size: 13px;
        z-index: 9999;
    }
    .news-panel h4 {
        margin: 0 0 6px 0;
        font-size: 14px;
        color: #333;
    }
    .news-message {
        min-height: 36px;
        line-height: 1.25;
    }

    /* Right side notifications - iPhone style */
    .notif-container {
        position: fixed;
        right: 12px;
        bottom: 12px;
        display: flex;
        flex-direction: column;
        gap: 12px;
        z-index: 10000;
        align-items: flex-end;
        max-width: 350px;
        max-height: 70vh;
        overflow-y: auto;
        padding-right: 6px;
        scrollbar-width: thin;
        scrollbar-color: rgba(0,0,0,0.1) transparent;
    }
    .notif-container::-webkit-scrollbar {
        width: 6px;
    }
    .notif-container::-webkit-scrollbar-thumb {
        background-color: rgba(0,0,0,0.1);
        border-radius: 3px;
    }
    .notif {
        background: rgba(255 255 255 / 0.9);
        backdrop-filter: saturate(180%) blur(10px);
        box-shadow:
            0 1px 1px rgba(0,0,0,0.1),
            0 10px 15px rgba(0,0,0,0.05);
        border-radius: 25px;
        padding: 14px 20px;
        width: 320px;
        font-size: 15px;
        color: #111;
        border-left: 8px solid;
        cursor: default;
        opacity: 0;
        transform: translateX(120%);
        animation: slideIn 360ms ease forwards;
        user-select: none;
        position: relative;
    }
    .notif.win {
        border-color: #2ecc71;
    }
    .notif.info {
        border-color: #2b7cff;
    }
    .notif .title {
        font-weight: 700;
        margin-bottom: 6px;
        font-size: 17px;
    }
    .notif .close-btn {
        position: absolute;
        top: 6px;
        right: 12px;
        font-weight: 700;
        font-size: 18px;
        color: #888;
        cursor: pointer;
        user-select: none;
        transition: color 0.2s ease;
    }
    .notif .close-btn:hover {
        color: #333;
    }

    @keyframes slideIn {
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    /* Achievement modal */
    #achievementsModal {
        display: none;
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 10001;
        justify-content: center;
        align-items: center;
    }
    #achievementsContent {
        background: white;
        border-radius: 10px;
        padding: 20px 30px;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        text-align: left;
        font-size: 15px;
    }
    #achievementsContent h3 {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 22px;
        text-align: center;
    }
    #achievementsContent ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    #achievementsContent li {
        margin-bottom: 10px;
    }
    #achievementsContent label {
        cursor: default;
        user-select: none;
    }
    #closeAchievements {
        display: block;
        margin: 20px auto 0;
        padding: 10px 20px;
        cursor: pointer;
        background: #2b7cff;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
    }

    /* Import/export panel */
    #importExportPanel {
        margin-top: 10px;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
        text-align: left;
    }
    #importExportPanel textarea {
        width: 100%;
        height: 80px;
        font-family: monospace;
        font-size: 14px;
        resize: vertical;
        margin-top: 6px;
        margin-bottom: 10px;
        padding: 6px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }
    #importExportPanel button {
        width: 22%;
        margin-right: 4%;
        box-sizing: border-box;
    }
    #importExportPanel button:last-child {
        margin-right: 0;
    }

    /* Blur effect for hide/show */
    #dataString.blurred {
        filter: blur(8px);
        user-select: none;
    }
</style>
</head>
<body>

<div id="disclaimer">
    âš  <b>Entertainment Only:</b> This site is for fun and does not promote gambling.
    No real money or prizes are involved.
</div>

<!-- Black ticker banner -->
<div id="ticker"></div>

<button id="enterBtn">Enter Ticket</button>
<button id="achievementsBtn">Achievements</button>

<div id="result"></div>

<div id="stats">
    Draws: <span id="draws">0</span><br />
    Wins: <span id="wins">0</span><br />
    Win %: <span id="winPercent">0%</span>
</div>

<div id="importExportPanel">
    <label for="dataString">Save Data:</label>
    <textarea id="dataString" placeholder="Type in the code from an exported game / The exported code will be posted here for you to copy"></textarea>
    <div>
        <button id="exportBtn">Export</button>
        <button id="importBtn">Import</button>
        <button id="hideCodeBtn">Hide Code</button>
        <button id="showCodeBtn" style="display:none;">Show Code</button>
    </div>
</div>

<!-- Left-side news -->
<div class="news-panel" id="newsPanel">
    <h4>ðŸ“° Lottery News</h4>
    <div class="news-message" id="newsMessage">Loading fun facts...</div>
</div>

<!-- Right-side notifications -->
<div class="notif-container" id="notifContainer"></div>

<!-- Achievements modal -->
<div id="achievementsModal">
    <div id="achievementsContent">
        <h3>Achievements</h3>
        <ul id="achievementsList">
            <li><label><input type="checkbox" id="achvLucky" disabled /> Lucky Person - Win the lottery once.</label></li>
            <li><label><input type="checkbox" id="achvFortune" disabled /> Fourtune teller - Win the lottery four times.</label></li>
            <li><label><input type="checkbox" id="achvCreator" disabled /> Creator - Win the lottery ten times.</label></li>
            <li><label><input type="checkbox" id="achvDoubleDown" disabled /> Double Down - Win the lottery twice in a row.</label></li>
            <li><label><input type="checkbox" id="achvAFK" disabled /> AFK fr - Win the lottery a hundred times.</label></li>
        </ul>
        <button id="closeAchievements">Close</button>
    </div>
</div>

<script>
    const WIN_ODDS = 1 / 134490400;

    const phrases = [
        "You win some, you lose more.",
        "Chances are, you're about to lose.",
        "The odds are not in your favor.",
        "Losing is the default outcome.",
        "Fun is free, but real gambling costs more."
    ];

    const newsFacts = [
        "In 2016, a Powerball jackpot reached $1.586 billion â€” split by 3 winners.",
        "Your odds of winning the US Powerball jackpot are 1 in 292,201,338.",
        "The largest single-ticket Mega Millions win was $1.537 billion in 2018.",
        "Mathematicians suggest you're more likely to be struck by lightning twice than win big.",
        "Some winners have lost it all within 5 years â€” cautionary tales are real.",
        "In 2003, 110 people 'won' due to identical numbers from fortune cookies.",
        "Japan's lottery often donates a large portion to public projects.",
        "One man in Australia won the lottery twice â€” in one week.",
        "The UK National Lottery has created over 6,300 millionaires since 1994."
    ];

    const goofyMessages = [
        "Statistically speaking, you'd have better odds finding a gold coin in your tap water.",
        "At this point, just get accepted to harvard. At the end of the day, you have a better chance making it in than winning here.",
        "Rumor has it, winning is rare. Groundbreaking news, I know.",
        "Maybe check under your couch cushions â€” can't hurt.",
        "Still here? Love the commitment.",
        "I'm not saying it's impossible, butâ€¦ yeah.",
        "Be honest, you're going to brag to your friends if you win. Don't worry. I would too.",
        "You're playing with the universe now. Good luck.",
        "If you win, I call dibs on gum.",
        "Just finished watching the entire One Piece show.",
        "Beautiful day here in Kepler-22b.",
        "Guess what. Nothing",
        "This is Jhon from the Microsof Databayse defence. We hav detect viruses on your computer. Pay me full bitecoin to prevant your dayta getting leeked."
    ];

    // --- Cookie helpers ---
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }
    function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(";");
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === " ") c = c.substring(1);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length);
        }
        return null;
    }

    // Secure encoding/decoding functions
    function secureEncode(obj) {
        const jsonStr = JSON.stringify(obj);
        const b64 = btoa(jsonStr);
        
        // Add verification hash based on content
        let hash = 0;
        for (let i = 0; i < jsonStr.length; i++) {
            hash = ((hash << 5) - hash + jsonStr.charCodeAt(i)) & 0xffffffff;
        }
        const hashHex = (hash >>> 0).toString(16).padStart(8, '0');
        
        // Inject hash characters throughout the base64 string
        let result = '';
        let hashIndex = 0;
        for (let i = 0; i < b64.length; i++) {
            result += b64[i];
            if ((i + 1) % 7 === 0 && hashIndex < hashHex.length) {
                result += hashHex[hashIndex++];
            }
        }
        // Add remaining hash characters at the end
        while (hashIndex < hashHex.length) {
            result += hashHex[hashIndex++];
        }
        
        return result;
    }

    function secureDecode(encoded) {
        try {
            // Extract the original base64 by removing injected characters
            let b64 = '';
            let removedChars = '';
            
            for (let i = 0; i < encoded.length; i++) {
                if ((i + 1) % 8 === 0 && i < encoded.length - 8) {
                    removedChars += encoded[i];
                } else if (i >= encoded.length - 8 && b64.length % 7 !== 0) {
                    removedChars += encoded[i];
                } else {
                    b64 += encoded[i];
                }
            }
            
            const jsonStr = atob(b64);
            
            // Verify hash
            let hash = 0;
            for (let i = 0; i < jsonStr.length; i++) {
                hash = ((hash << 5) - hash + jsonStr.charCodeAt(i)) & 0xffffffff;
            }
            const expectedHash = (hash >>> 0).toString(16).padStart(8, '0');
            
            if (removedChars !== expectedHash) {
                throw new Error('Invalid verification hash');
            }
            
            return JSON.parse(jsonStr);
        } catch (e) {
            throw new Error('Invalid save data format or corrupted code');
        }
    }

    // Stats
    let draws = parseInt(getCookie("draws") || "0");
    let wins = parseInt(getCookie("wins") || "0");
    let lastWasWin = getCookie("lastWasWin") === "true";

    // Money debt tracking
    let moneyDebt = parseInt(getCookie("moneyDebt") || "0");
    function updateMoneyDebt() {
        if (!document.getElementById("moneyDebt")) {
            const d = document.createElement("div");
            d.id = "moneyDebt";
            d.style.marginTop = "12px";
            d.style.fontSize = "16px";
            d.style.fontWeight = "600";
            document.getElementById("stats").appendChild(d);
        }
        document.getElementById("moneyDebt").textContent = `Money owed: $${moneyDebt.toLocaleString()}`;
    }
    updateMoneyDebt();

    function updateStats() {
        document.getElementById("draws").textContent = draws;
        document.getElementById("wins").textContent = wins;
        let percent = draws > 0 ? ((wins / draws) * 100).toFixed(6) : 0;
        document.getElementById("winPercent").textContent = percent + "%";
        setCookie("draws", draws, 365);
        setCookie("wins", wins, 365);
    }
    updateStats();

    // News rotation
    let newsIndex = 0;
    function showNews() {
        document.getElementById("newsMessage").textContent = newsFacts[newsIndex];
        newsIndex = (newsIndex + 1) % newsFacts.length;
    }
    showNews();
    setInterval(showNews, 15000);

    // Notifications
    const notifContainer = document.getElementById("notifContainer");

    function addNotification(message, type = "info", timeout = 5000) {
        const n = document.createElement("div");
        n.className = `notif ${type}`;
        const title = type === "win" ? "ðŸŽ‰ WINNER!" : "ðŸ’¡ Messages";

        // Add close button for dismissal
        const closeBtn = document.createElement("span");
        closeBtn.textContent = "Ã—";
        closeBtn.className = "close-btn";
        closeBtn.title = "Dismiss";
        closeBtn.onclick = () => n.remove();

        n.innerHTML = `<div class="title">${title}</div>${message}`;
        n.appendChild(closeBtn);
        notifContainer.appendChild(n);

        setTimeout(() => {
            if (n.parentElement) {
                n.style.opacity = "0";
                n.style.transform = "translateX(120%)";
                setTimeout(() => n.remove(), 300);
            }
        }, timeout);
    }

    // Achievement unlocking and display
    const achievements = {
        lucky: false,
        fortune: false,
        creator: false,
        doubleDown: false,
        afk: false,
    };

    function loadAchievements() {
        for (const key in achievements) {
            const val = getCookie("achv_" + key);
            achievements[key] = val === "true";
        }
    }
    loadAchievements();

    function saveAchievements() {
        for (const key in achievements) {
            setCookie("achv_" + key, achievements[key], 365);
        }
    }

    function checkAchievements(currentWin) {
        if (wins >= 1) achievements.lucky = true;
        if (wins >= 4) achievements.fortune = true;
        if (wins >= 10) achievements.creator = true;
        if (wins >= 100) achievements.afk = true;
        if (lastWasWin && currentWin) achievements.doubleDown = true;

        saveAchievements();
    }

    function updateAchievementsUI() {
        document.getElementById("achvLucky").checked = achievements.lucky;
        document.getElementById("achvFortune").checked = achievements.fortune;
        document.getElementById("achvCreator").checked = achievements.creator;
        document.getElementById("achvDoubleDown").checked = achievements.doubleDown;
        document.getElementById("achvAFK").checked = achievements.afk;
    }
    updateAchievementsUI();

    // Button click for lottery entry
    document.getElementById("enterBtn").addEventListener("click", () => {
        draws++;
        moneyDebt -= 15; // $15 cost per draw (adds debt)

        let won = Math.random() < WIN_ODDS;
        if (won) {
            wins++;
            document.getElementById("result").textContent = "ðŸŽ‰ You WON the lottery! ðŸŽ‰";
            addNotification("dudee. remember when i gave you gum?", "win", 10000);

            const jackpot = 100000000; // $100 million payout
            moneyDebt += jackpot; // pay off debt
            if (moneyDebt > 0) moneyDebt = 0; // no positive balance, just zero
        } else {
            document.getElementById("result").textContent = "âŒ You lost. Try again.";
        }

        // Show goofy notification every 1000 draws
        if (draws % 1000 === 0) {
            const msg = goofyMessages[Math.floor(Math.random() * goofyMessages.length)];
            addNotification(msg, "info", 7000);
        }

        checkAchievements(won);
        updateAchievementsUI();
        updateStats();
        updateMoneyDebt();

        lastWasWin = won;
        setCookie("lastWasWin", lastWasWin, 365);
        setCookie("moneyDebt", moneyDebt, 365);
    });

    // Ticker rotation
    let tickerIndex = 0;
    function updateTicker() {
        document.getElementById("ticker").textContent = phrases[tickerIndex];
        tickerIndex = (tickerIndex + 1) % phrases.length;
    }
    updateTicker();
    setInterval(updateTicker, 4000);

    // Achievements modal toggle
    const modal = document.getElementById("achievementsModal");
    document.getElementById("achievementsBtn").addEventListener("click", () => {
        modal.style.display = "flex";
    });
    document.getElementById("closeAchievements").addEventListener("click", () => {
        modal.style.display = "none";
    });

    // Import / Export save data
    const exportBtn = document.getElementById("exportBtn");
    const importBtn = document.getElementById("importBtn");
    const dataString = document.getElementById("dataString");

    exportBtn.addEventListener("click", () => {
        const saveObj = {
            draws,
            wins,
            moneyDebt,
            achievements,
            lastWasWin,
        };
        dataString.value = secureEncode(saveObj);
    });

    importBtn.addEventListener("click", () => {
        try {
            const decoded = secureDecode(dataString.value);
            if (
                typeof decoded.draws === "number" &&
                typeof decoded.wins === "number" &&
                typeof decoded.moneyDebt === "number" &&
                typeof decoded.achievements === "object" &&
                typeof decoded.lastWasWin === "boolean"
            ) {
                draws = decoded.draws;
                wins = decoded.wins;
                moneyDebt = decoded.moneyDebt;
                Object.assign(achievements, decoded.achievements);
                lastWasWin = decoded.lastWasWin;
                updateStats();
                updateAchievementsUI();
                updateMoneyDebt();
                setCookie("draws", draws, 365);
                setCookie("wins", wins, 365);
                setCookie("moneyDebt", moneyDebt, 365);
                setCookie("lastWasWin", lastWasWin, 365);
                for (const key in achievements) {
                    setCookie("achv_" + key, achievements[key], 365);
                }
                alert("Save data imported successfully!");
            } else {
                alert("Invalid save data format.");
            }
        } catch (e) {
            alert("Failed to import save data. Check input format.");
        }
    });

    // Hide / Show code buttons
    const hideCodeBtn = document.getElementById("hideCodeBtn");
    const showCodeBtn = document.getElementById("showCodeBtn");

    hideCodeBtn.addEventListener("click", () => {
        dataString.classList.add("blurred");
        hideCodeBtn.style.display = "none";
        showCodeBtn.style.display = "inline-block";
    });

    showCodeBtn.addEventListener("click", () => {
        dataString.classList.remove("blurred");
        showCodeBtn.style.display = "none";
        hideCodeBtn.style.display = "inline-block";
    });
</script>
</body>
</html>